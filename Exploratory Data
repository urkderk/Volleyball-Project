vball = read.table('clean_data.csv', header = TRUE, sep = ',')
vball
str(vball)

## t-test on height vs. spike vs. block ??
plot(spike ~ height, data = vball)
lr1 = lm(formula = spike ~ height, data = vball)
summary (lr1)
anova(lr1)
t.test.lr1 = t.test(x = vball$height, y = vball$spike, alternative = "two.sided",
                       paired = FALSE, var.equal = TRUE)
t.test.lr1   ####“true difference in means is not equal to 0” = there is a statistical difference between the two means.
##we can REJECT the null hypo and accept the alternative hypothesis that there is a statistical difference between the two means.


## it looks like that height influences spike height as

### null hypothesis = no difference among group means
 # p-value < alpha value = null hypo REJECTED 

plot(block ~ height, data = vball)
lr2 = lm(formula = block ~ height, data = vball)
summary(lr2)
anova(lr2)
t.test.lr2 = t.test(x = vball$height, y = vball$block, alternative = "two.sided",
                    paired = FALSE, var.equal = TRUE)
t.test.lr2
## height also influences block height

##independent variables are on x-axis and dependent on y-axis 
## If the p-value for F statistics Pr(>F)is less than our significance level, we reject the null hypothesis.

table(vball$country)
## i can compare countries 5, 10, 19, 23, 24, 29, 30, and 31 since they have the same # of observations

## box plots comparing  the countries 5, 10, 19 & 23
country5 = subset(vball, country == 5)
heightcountry5 = country5$height

country10 = subset(vball, country == 10)
heightcountry10 = country10$height

country19 = subset(vball, country == 19)
heightcountry19 = country19$height

country23 = subset(vball, country == 23)
heightcountry23 = country23$height

boxplot(heightcountry5, heightcountry10, heightcountry19, heightcountry23,
        ylab = "Height",
        names = c("Country 5", "Country 10", "Country 19", "Country 23"))
plot(height ~ country, data=vball)

#want only the subsetted data of countries 5, 10, 19, & 23
lr.c = lm(formula = height ~ country, data = vball)
## want to to anova of countries and their heights w/ subsetted data but its hard :((

plot(height ~ position_number, 
     xlab = "Position Number", ylab = "Height",
     data = vball)
lr.pn = (lm(formula = height ~ position_number, data = vball))

anova(object = lr.pn)

## looks like height isn't dependent on position number


## finding how many countries look for specific positions in volleyball 

positions.c.19 = table(country19$position_number)
positions.c.19

positions.c.23 = table(country23$position_number)
positions.c.23



### bar graphs of the countries 

vball$country = as.factor(vball$country)
str(vball)
vball$position_number= as.factor(vball$position_number)

ggplot(data=vball, aes(x=position_number, y=height, color=country)) + 
  geom_point()

ggplot(vball, aes(x=country, fill= position_number)) + 
  geom_bar(position = "dodge") 
